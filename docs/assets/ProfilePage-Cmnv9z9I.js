import{j as e,A as M,m as n,l as L,S as H,f as V,c as E,r as i,h as S,d as Z,i as D}from"./index-YxfBBWVY.js";import{M as F}from"./MovieCard-D_wDkgZ_.js";const I=({isOpen:t,onConfirm:o,onCancel:r,message:a="Вы уверены, что хотите удалить фильм из избранного?",loading:l=!1})=>{const c={hidden:{opacity:0},visible:{opacity:1}},d={hidden:{opacity:0,scale:.9,y:20},visible:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20}};return e.jsx(M,{children:t&&e.jsx(n.div,{className:"confirm-modal-overlay",role:"dialog","aria-modal":"true",initial:"hidden",animate:"visible",exit:"hidden",variants:c,onClick:l?void 0:r,style:{pointerEvents:l?"none":"auto"},children:e.jsxs(n.div,{className:"confirm-modal-content",onClick:m=>m.stopPropagation(),variants:d,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.25},children:[e.jsx("img",{src:L,alt:"logo-marusia"}),e.jsx("p",{className:"confirm-modal-message",children:a}),l?e.jsxs("div",{className:"confirm-modal-loader",children:[e.jsx(H,{}),e.jsx("p",{children:"Удаление..."})]}):e.jsxs("div",{className:"confirm-modal-buttons",children:[e.jsx("button",{type:"button",onClick:r,disabled:l,children:"Отмена"}),e.jsx("button",{type:"button",onClick:o,autoFocus:!0,disabled:l,children:"Удалить"})]})]})})})},P="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12%2021.35L10.55%2020.03C5.4%2015.36%202%2012.28%202%208.5C2%205.42%204.42%203%207.5%203C9.24%203%2010.91%203.81%2012%205.09C13.09%203.81%2014.76%203%2016.5%203C19.58%203%2022%205.42%2022%208.5C22%2012.28%2018.6%2015.36%2013.45%2020.03L12%2021.35Z'%20fill='none'%20stroke='white'%20stroke-width='1.5'%20/%3e%3c/svg%3e",A="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4%2022C4%2017.5817%207.58172%2014%2012%2014C16.4183%2014%2020%2017.5817%2020%2022H18C18%2018.6863%2015.3137%2016%2012%2016C8.68629%2016%206%2018.6863%206%2022H4ZM12%2013C8.685%2013%206%2010.315%206%207C6%203.685%208.685%201%2012%201C15.315%201%2018%203.685%2018%207C18%2010.315%2015.315%2013%2012%2013ZM12%2011C14.21%2011%2016%209.21%2016%207C16%204.79%2014.21%203%2012%203C9.79%203%208%204.79%208%207C8%209.21%209.79%2011%2012%2011Z'%20fill='white'/%3e%3c/svg%3e",T="data:image/svg+xml,%3csvg%20width='22'%20height='18'%20viewBox='0%200%2022%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M21%200C21.5523%200%2022%200.44772%2022%201V17.0066C22%2017.5552%2021.5447%2018%2021.0082%2018H2.9918C2.44405%2018%202%2017.5551%202%2017.0066V16H20V4.3L12%2011.5L2%202.5V1C2%200.44772%202.44772%200%203%200H21ZM8%2012V14H0V12H8ZM5%207V9H0V7H5ZM19.5659%202H4.43414L12%208.8093L19.5659%202Z'%20fill='white'/%3e%3c/svg%3e",j=t=>t?.[0]?.toUpperCase()??"",B=(t,o)=>!t&&!o?"-":`${t??""} ${o??""}`.trim(),x={initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.4}},$=()=>{const{user:t,logout:o}=V(),r=E(),[a,l]=i.useState("favorites"),[c,d]=i.useState([]),[m,u]=i.useState(!1),[C,h]=i.useState(!1),[f,p]=i.useState(null),[v,g]=i.useState(!1),N=async()=>{await o(),r("/")},b=s=>{p(s),h(!0)},y=async()=>{if(f!==null){g(!0);try{await D(f),d(s=>s.filter(k=>k.id!==f))}catch(s){console.error("Ошибка при удалении фильма:",s)}finally{g(!1),h(!1),p(null)}}},w=()=>{v||(h(!1),p(null))};i.useEffect(()=>{a==="favorites"&&_()},[a]);const _=async()=>{u(!0);try{const s=await S();d(s)}catch(s){console.error("Ошибка при загрузке избранного:",s)}finally{u(!1)}};return i.createElement(n.div,{className:"profile-page",...x,key:a},e.jsx("h1",{className:"profile-title",children:"Мой аккаунт"}),e.jsxs("div",{className:"profile-tabs",children:[e.jsxs("button",{onClick:()=>l("favorites"),className:a==="favorites"?"active":"",children:[e.jsx("img",{src:P,alt:"Избранное"}),e.jsx("span",{className:"profile-tabs__title",children:"Избранные фильмы"}),e.jsx("span",{className:"profile-tabs__title--mobile",children:"Избранное"})]}),e.jsxs("button",{onClick:()=>l("settings"),className:a==="settings"?"active":"",children:[e.jsx("img",{src:A,alt:"Настройки"}),e.jsx("span",{className:"profile-tabs__title",children:"Настройки аккаунта"}),e.jsx("span",{className:"profile-tabs__title--mobile",children:"Настройки"})]})]}),a==="favorites"&&i.createElement(n.div,{className:"profile-favorites",...x,key:"favorites-content"},m?e.jsx(Z,{}):c.length===0?e.jsx("p",{children:"Вы ещё не добавили фильмы в избранное."}):e.jsxs("section",{className:"home__top profile__top",children:[e.jsx("h2",{className:"home__top-title",children:"Избранные фильмы"}),e.jsx("div",{className:"home__top-list profile__top-list",children:c.map(s=>e.jsx(F,{movie:s,variant:"default",onRemove:()=>b(s.id)},s.id))})]})),a==="settings"&&i.createElement(n.div,{className:"profile-settings",...x,key:"settings-content"},e.jsxs("div",{className:"profile-user-blocks",children:[e.jsxs("div",{className:"profile-user-block",children:[e.jsxs("div",{className:"profile-user-initials",children:[j(t?.name),j(t?.surname)]}),e.jsxs("div",{className:"profile-user-texts",children:[e.jsx("h3",{children:"Имя и Фамилия"}),e.jsx("p",{children:B(t?.name,t?.surname)})]})]}),e.jsxs("div",{className:"profile-user-block",children:[e.jsx("div",{className:"profile-user-initials",children:e.jsx("img",{src:T,alt:"Email",className:"profile-user-email-icon"})}),e.jsxs("div",{className:"profile-user-texts",children:[e.jsx("h3",{children:"Электронная почта"}),e.jsx("p",{children:t?.email||"-"})]})]})]}),e.jsx("button",{className:"logout-btn",onClick:N,children:"Выйти из аккаунта"})),e.jsx(I,{isOpen:C,onConfirm:y,onCancel:w,message:v?"Удаление...":"Удалить фильм из избранного?",loading:v}))};export{$ as default};
