import{u as M,c as b,r as t,j as e,A as j,m as N,N as w,d as L,e as k}from"./index-YxfBBWVY.js";import{g as m}from"./genresMap-FYua7ZVe.js";import{M as E}from"./MovieCard-D_wDkgZ_.js";const _="data:image/svg+xml,%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18.0473%2020.0012L26.2969%2028.2507L23.9399%2030.6077L13.3333%2020.0012L23.9399%209.39453L26.2969%2011.7515L18.0473%2020.0012Z'%20fill='white'/%3e%3c/svg%3e",r=10,C={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}},exit:{opacity:0,y:20,transition:{duration:.3}}},S={hidden:{opacity:0,y:10},visible:s=>({opacity:1,y:0,transition:{delay:s*.05,duration:.3}})},I=()=>{const{key:s}=M(),u=b(),a=t.useRef(!0),[n,o]=t.useState([]),[h,c]=t.useState(r),[l,p]=t.useState(!1),[v,x]=t.useState(null);t.useEffect(()=>{(!s||!m[s])&&u("/genres",{replace:!0})},[s,u]);const d=s?{name:m[s]?.name||s.charAt(0).toUpperCase()+s.slice(1),image:m[s]?.image||"/genres/default.png"}:null;if(t.useEffect(()=>s?(a.current=!0,x(null),o([]),c(r),(async()=>{try{p(!0);const g=await k({genre:s,sortBy:"tmdbRating",sortOrder:"desc"});a.current&&(o(g),c(r))}catch{a.current&&(x("Не удалось загрузить фильмы"),o([]))}finally{a.current&&p(!1)}})(),()=>{a.current=!1}):void 0,[s]),!d)return null;const f=n.slice(0,h),y=h<n.length;return e.jsx(j,{children:e.jsxs(N.div,{className:"genre-page",variants:C,initial:"hidden",animate:"visible",exit:"exit",children:[e.jsx("div",{className:"genre-page__top",children:e.jsxs(w,{to:"/genres",className:"back-button",children:[e.jsx("img",{className:"genre-img",src:_,alt:"Назад",width:40,height:40}),e.jsx("h1",{className:"genre-title",children:d.name})]})}),v&&e.jsxs("div",{className:"error-message",children:[v,e.jsx("button",{onClick:()=>window.location.reload(),className:"retry-button",children:"Повторить"})]}),e.jsx("div",{className:"genre-movie-list",children:e.jsx(j,{children:f.length>0?f.map((i,g)=>e.jsx(N.div,{custom:g,variants:S,initial:"hidden",animate:"visible",exit:"hidden",children:e.jsx(E,{movie:i})},i.id)):!l&&e.jsxs("p",{children:['Фильмы не найдены для жанра "',d.name,'"']})})}),l&&e.jsx("div",{className:"loading-indicator",children:e.jsx(L,{})}),y&&!l&&e.jsx("button",{onClick:()=>c(i=>Math.min(i+r,n.length)),className:"genre-page__load-more",children:"Показать ещё"}),!y&&n.length>0&&e.jsx("p",{className:"genre-page__loaded",children:"Все фильмы загружены"})]})})};export{I as default};
